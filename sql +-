INSERT INTO notafiscalentrada_rateiodocumento 
 (grupo, 
 empresa, 
 cnpjcpfcodigo, 
 dtemissao, 
 serie, 
 numero, 
 sequencia, 
 dtinc,
 dtalt, 
 tipodocumento, 
 grupodocumento, 
 empresadocumento,
 filialdocumento, 
 unidadedocumento, 
 cnpjcpfcodigodocumento, 
 dtemissaodocumento,
 diferenciadornumerodocumento, 
 seriedocumento, 
 numerosequenciadocumento, 
 pesodocumento, 
 valor, 
 tipocusto)
 
values(
notafiscalentrada.grupo,
notafiscalentrada.empresa,
notafiscalentrada.cpfcnpjcodigo,
notafiscalentrada.dtemissao,
notafiscalentrada.serie,
notafiscalentrada.numero,
coalesce((select max(sequencia) from notafiscalentrada_rateiodocumento where grupo= notafiscalentrada.grupo and empresa=notafiscalentrada.empresa and cnpjcpfcodigo=notafiscalentrada.cpfcnpjcodigo and dtemissao=notafiscalentrada.dtemissao and serie=notafiscalentrada.serie and numero=notafiscalentrada.numero),1)+1,
now(),
null,
crt.tipodocumento
crt.grupo
crt.empresa,
crt.filial,
crt.unidade,
null,
crt.dtemissao,
crt.diferenciadorsequencia,
crt.sequencia,
crt.pesobruto, --arredondado
valor, 
tipocusto
)